module.exports=function(t){var e={};function o(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=49)}([function(t,e){t.exports=flarum.core.compat["common/Model"]},function(t,e,o){"use strict";function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n(t,e)}o.d(e,"a",(function(){return a}))},function(t,e){t.exports=flarum.core.compat["common/extend"]},function(t,e){t.exports=flarum.core.compat["common/components/Button"]},function(t,e,o){"use strict";e.a=function(t){return!1===t&&(t=[]),t.slice(0).sort((function(t,e){var o=t.order()-e.order();return 0!==o?o:t.name()>e.name()?1:t.name()<e.name()?-1:0}))}},function(t,e){t.exports=flarum.core.compat["common/utils/withAttr"]},function(t,e){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o(11),a=o.n(n);function r(t,e,o){void 0===e&&(e={}),void 0===o&&(o={});var n=t&&t.icon(),r=o.useColor,i=void 0===r||r;return e.className=a()([e.className,"icon",n?t.icon():"TaxonomyIcon"]),t?(e.style=e.style||{},n?e.style.color=i?t.color():"":e.style.backgroundColor=t.color()):e.className+=" untagged",n?m("i",e):m("span",e)}},function(t,e){t.exports=flarum.core.compat["common/utils/extract"]},function(t,e,o){"use strict";o.d(e,"a",(function(){return I}));var n=o(1),a=o(15),r=o.n(a),i=o(18),s=o.n(i),l=o(3),u=o.n(l),c=o(6),p=o.n(c),d=o(27),h=o.n(d),f=o(11),x=o.n(f),v=o(19),y=o.n(v),b=o(10),g=o.n(b),T=o(13),w=o(7),k=o(16),F=function(){function t(){this.callbacks=new Map,this.whenCallback=function(t){return!0}}var e=t.prototype;return e.onUp=function(t){return this.callbacks.set(38,(function(e){e.preventDefault(),t(e)})),this},e.onDown=function(t){return this.callbacks.set(40,(function(e){e.preventDefault(),t(e)})),this},e.onSelect=function(t){var e=function(e){e.preventDefault(),t(e)};return this.callbacks.set(9,e),this.callbacks.set(13,e),this},e.onCancel=function(t){return this.callbacks.set(27,(function(e){e.stopPropagation(),e.preventDefault(),t(e)})),this},e.onRemove=function(t){return this.callbacks.set(8,(function(e){0===e.target.selectionStart&&0===e.target.selectionEnd&&(t(e),e.preventDefault())})),this},e.when=function(t){return this.whenCallback=t,this},e.bindTo=function(t){t.on("keydown",this.navigate.bind(this))},e.navigate=function(t){if(this.whenCallback(t)){var e=this.callbacks.get(t.which);e&&e(t)}},t}();var I=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).availableTerms=null,e.selectedTerms=[],e.searchFilter="",e.activeListIndex=0,e.inputIsFocused=!1,e.saving=!1,e.navigator=void 0,e.attrs=void 0,e}Object(n.a)(e,t);var o=e.prototype;return o.oninit=function(e){var o=this;t.prototype.oninit.call(this,e),this.attrs.selectedTerms?this.attrs.selectedTerms.forEach(this.addTerm.bind(this)):this.attrs.resource&&this.attrs.resource.taxonomyTerms().forEach((function(t){t.taxonomy().id()===o.attrs.taxonomy.id()&&o.addTerm(t)})),app.request({method:"GET",url:app.forum.attribute("apiUrl")+this.attrs.taxonomy.apiEndpoint()+"/terms"}).then((function(t){o.availableTerms=app.store.pushPayload(t),m.redraw()})),this.navigator=new F,this.navigator.onUp((function(){return o.setIndex(o.activeListIndex-1,!0)})).onDown((function(){return o.setIndex(o.activeListIndex+1,!0)})).onSelect(this.select.bind(this)).onRemove((function(){o.selectedTerms.length&&o.toggleTerm(o.selectedTerms[o.selectedTerms.length-1])})).when((function(t){return" "!==t.key||""!==o.searchFilter||(t.preventDefault(),o.select(t),!1)}))},o.indexInSelectedTerms=function(t){return this.selectedTerms.findIndex((function(e){return n=t,(o=e).data.type===n.data.type&&(o.id()&&n.id()?o.id()===n.id():!o.id()==!n.id()&&o.name()===n.name());var o,n}))},o.addTerm=function(t){this.selectedTerms.push(t)},o.removeTerm=function(t){var e=this.indexInSelectedTerms(t);-1!==e&&this.selectedTerms.splice(e,1)},o.className=function(){return"ChooseTaxonomyTermsModal"},o.title=function(){return this.attrs.resource?app.translator.trans("flamarkt-taxonomies.lib.modal.title.edit",{taxonomy:this.attrs.taxonomy.name(),title:m("em",this.attrs.resource.title?this.attrs.resource.title():this.attrs.resource.displayName())}):app.translator.trans("flamarkt-taxonomies.lib.modal.title.new",{taxonomy:this.attrs.taxonomy.name()})},o.getInstruction=function(){var t=this.selectedTerms.length;if(this.attrs.taxonomy.minTerms()&&t<this.attrs.taxonomy.minTerms()){var e=this.attrs.taxonomy.minTerms()-t;return app.translator.trans("flamarkt-taxonomies.lib.modal.placeholder",{count:e})}return 0===t?app.translator.trans("flamarkt-taxonomies.lib.modal.placeholderOptional"):""},o.filteredAvailableTerms=function(){var t=null===this.availableTerms?[]:this.availableTerms,e=this.searchFilter.toLowerCase();if(e&&(t=t.filter((function(t){return t.name().substr(0,e.length).toLowerCase()===e})),this.attrs.taxonomy.allowCustomValues()&&!t.some((function(t){return t.name().toLowerCase()===e})))){var o=this.attrs.taxonomy.customValueValidation(),n=null;if("alpha_num"===o)n=/^[a-z0-9]$/i;else if("alpha_dash"===o)n=/^[a-z0-9_-]$/i;else if(0===o.indexOf("/")){var a=o.split("/");3===a.length&&(n=new RegExp(a[1],a[2]))}n&&!n.test(this.searchFilter)||t.push(app.store.createRecord("flamarkt-taxonomy-terms",{attributes:{name:this.searchFilter}}))}return this.attrs.taxonomy.maxTerms()&&this.selectedTerms.length>=this.attrs.taxonomy.maxTerms()&&(t=[]),t},o.content=function(){return[this.viewForm(),this.listAvailableTerms(this.filteredAvailableTerms())]},o.viewForm=function(){var t=this.attrs.taxonomy.description();return m(".Modal-body",[t?m("p",t):null,m(".ChooseTaxonomyTermsModal-form",this.formItems().toArray())])},o.formItems=function(){var t=new y.a;return t.add("input",m(".ChooseTaxonomyTermsModal-form-input",m(".TermsInput.FormControl",{className:this.inputIsFocused?"focus":""},this.inputItems().toArray())),20),t.add("submit",m(".ChooseTaxonomyTermsModal-form-submit.App-primaryControl",u.a.component({type:"submit",className:"Button Button--primary",disabled:this.attrs.taxonomy.minTerms()&&this.selectedTerms.length<this.attrs.taxonomy.minTerms(),icon:"fas fa-check",loading:this.saving},app.translator.trans("flamarkt-taxonomies.lib.modal.submit"))),10),t},o.inputItems=function(){var t=this,e=new y.a;return e.add("selected",this.selectedTerms.map((function(e){return m("span.TermsInput-term",{onclick:function(){t.toggleTerm(e),t.onready()}},Object(T.a)(e))})),20),e.add("control",m("input.FormControl",{placeholder:g()(this.getInstruction()),value:this.searchFilter,oninput:function(e){t.searchFilter=e.target.value,t.activeListIndex=0},onkeydown:this.navigator.navigate.bind(this.navigator),onfocus:this.oninputfocus.bind(this),onblur:this.oninputblur.bind(this)}),10),e},o.oninputfocus=function(){this.inputIsFocused=!0},o.oninputblur=function(){this.inputIsFocused=!1},o.listAvailableTerms=function(t){return m(".Modal-footer",null===this.availableTerms?p.a.component():m("ul.ChooseTaxonomyTermsModal-list.SelectTermList",{className:t.some((function(t){return t.description()}))?"SelectTermList--with-descriptions":""},t.map(this.listAvailableTerm.bind(this))))},o.listAvailableTerm=function(t,e){var o=this;return m("li.SelectTermListItem",{"data-index":e,className:x()({colored:!!t.color(),selected:-1!==this.indexInSelectedTerms(t),active:this.activeListIndex===e}),style:{color:t.color()},onmouseover:function(){return o.activeListIndex=e},onclick:this.toggleTerm.bind(this,t)},[Object(w.a)(t),m("span.SelectTermListItem-name",t.exists?h()(t.name(),this.searchFilter):app.translator.trans("flamarkt-taxonomies.lib.modal.custom",{value:m("em",t.name())})),t.description()?m("span.SelectTermListItem-description",t.description()):""])},o.toggleTerm=function(t){var e=this;-1!==this.indexInSelectedTerms(t)?this.removeTerm(t):this.addTerm(t),this.searchFilter&&(this.searchFilter="",this.activeListIndex=0),setTimeout((function(){e.onready()}))},o.select=function(t){var e=this.getDomElement(this.activeListIndex);e.length?t.metaKey||t.ctrlKey||e.is(".selected")?this.selectedTerms.length&&this.onsubmit():e[0].dispatchEvent(new Event("click")):this.searchFilter=""},o.getDomElement=function(t){return this.$('.SelectTermListItem[data-index="'+t+'"]')},o.setIndex=function(t,e){var o=this.$(".ChooseTaxonomyTermsModal-list"),n=this.$(".SelectTermListItem").length;t<0?t=n-1:t>=n&&(t=0);var a=this.getDomElement(t);if(this.activeListIndex=t,m.redraw(),e){var r,i,s,l=o.scrollTop()||0,u=(null==(r=o.offset())?void 0:r.top)||0,c=u+(o.outerHeight()||0),p=(null==(i=a.offset())?void 0:i.top)||0,d=p+(a.outerHeight()||0);p<u?s=l-u+p-parseInt(o.css("padding-top"),10):d>c&&(s=l-c+d+parseInt(o.css("padding-bottom"),10)),void 0!==s&&o.stop(!0).animate({scrollTop:s},100)}},o.onsubmit=function(t){t&&t.preventDefault(),this.attrs.resource?this.saveResource():(this.attrs.onsubmit&&this.attrs.onsubmit(this.selectedTerms),app.modal.close())},o.saveResource=function(){this.saving=!0,this.attrs.resource.save({relationships:{taxonomies:[{verbatim:!0,type:"flamarkt-taxonomies",id:this.attrs.taxonomy.id(),relationships:{terms:{data:this.selectedTerms.map(k.a)}}}]}}).then(this.onsaved.bind(this),this.onerror.bind(this))},o.onsaved=function(){s.a&&app.current.matches(s.a)&&app.current.get("stream").update(),this.saving=!1,m.redraw(),app.modal.close()},o.onerror=function(){this.saving=!1,m.redraw()},e}(r.a)},function(t,e){t.exports=flarum.core.compat["common/utils/extractText"]},function(t,e){t.exports=flarum.core.compat["common/utils/classList"]},function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var n=o(1),a=o(0),r=o.n(a),i=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name=r.a.attribute("name"),e.slug=r.a.attribute("slug"),e.description=r.a.attribute("description"),e.color=r.a.attribute("color"),e.icon=r.a.attribute("icon"),e.order=r.a.attribute("order"),e.createdAt=r.a.attribute("createdAt",r.a.transformDate),e.taxonomy=r.a.hasOne("taxonomy"),e}return Object(n.a)(e,t),e.prototype.apiEndpoint=function(){return"/flamarkt/taxonomy-terms"+(this.exists?"/"+this.data.id:"")},e}(r.a)},function(t,e,o){"use strict";o.d(e,"a",(function(){return s}));var n=o(8),a=o.n(n),r=o(12),i=o(7);function s(t,e){void 0===t&&(t=null),void 0===e&&(e={}),e.style=e.style||{},e.className="TaxonomyLabel "+(e.className||"");var o=a()(e,"discussionLink"),n=a()(e,"userLink"),s=t?t.name():app.translator.trans("flarum-tags.lib.deleted_tag_text"),l="span";if(t){var u=t.color();if(u&&(e.style.backgroundColor=e.style.color=u,e.className+=" colored"),t instanceof r.a&&t.taxonomy()&&t.taxonomy().showFilter()){var c;if(o)e.title=t.description()||"",e.href=app.route("index",((c={})[t.taxonomy().slug()]=t.slug(),c)),e.config=m.route,l="a";n&&app.routes.fof_user_directory&&(e.title=t.description()||"",e.href=app.route("fof_user_directory",{q:"taxonomy:"+t.taxonomy().slug()+":"+t.slug()}),e.config=m.route,l="a")}}else e.className+=" untagged";return m(l,e,m("span.TaxonomyLabel-text",[t&&t.icon()&&Object(i.a)(t,{},{useColor:!1})," "+s]))}},function(t,e){t.exports=flarum.core.compat["common/helpers/icon"]},function(t,e){t.exports=flarum.core.compat["common/components/Modal"]},function(t,e,o){"use strict";var n=o(17),a=o(0),r=o.n(a);e.a=function(t){return t.id()?r.a.getIdentifier(t):Object(n.a)({},r.a.getIdentifier(t),{attributes:{name:t.name()}})}},function(t,e,o){"use strict";function n(){return(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}o.d(e,"a",(function(){return n}))},function(t,e){t.exports=flarum.core.compat["forum/components/DiscussionPage"]},function(t,e){t.exports=flarum.core.compat["common/utils/ItemList"]},function(t,e){t.exports=flarum.core.compat["common/components/LinkButton"]},function(t,e){t.exports=flarum.core.compat["common/Component"]},function(t,e,o){"use strict";e.a=function(t){return t.slice(0).sort((function(t,e){var o=t.order()-e.order();return 0!==o?o:t.name()>e.name()?1:t.name()<e.name()?-1:0}))}},function(t,e){t.exports=flarum.core.compat["common/models/Discussion"]},function(t,e){t.exports=flarum.core.compat["common/models/Forum"]},function(t,e){t.exports=flarum.core.compat["common/models/User"]},function(t,e){t.exports=flarum.extensions["flamarkt-core"].common["models/Product"]},function(t,e){t.exports=flarum.core.compat["common/helpers/highlight"]},function(t,e,o){"use strict";var n=o(23),a=o.n(n),r=o(24),i=o.n(r),s=o(25),l=o.n(s),m=o(0),u=o.n(m),c=o(26),p=o.n(c),d=o(1),h=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).type=u.a.attribute("type"),e.name=u.a.attribute("name"),e.slug=u.a.attribute("slug"),e.description=u.a.attribute("description"),e.color=u.a.attribute("color"),e.icon=u.a.attribute("icon"),e.order=u.a.attribute("order"),e.showLabel=u.a.attribute("showLabel"),e.showFilter=u.a.attribute("showFilter"),e.allowCustomValues=u.a.attribute("allowCustomValues"),e.customValueValidation=u.a.attribute("customValueValidation"),e.customValueSlugger=u.a.attribute("customValueSlugger"),e.minTerms=u.a.attribute("minTerms"),e.maxTerms=u.a.attribute("maxTerms"),e.createdAt=u.a.attribute("createdAt",u.a.transformDate),e.canSearch=u.a.attribute("canSearch"),e}Object(d.a)(e,t);var o=e.prototype;return o.apiEndpoint=function(){return"/flamarkt/taxonomies"+(this.exists?"/"+this.data.id:"")},o.apiOrderEndpoint=function(){return this.apiEndpoint()+"/terms/order"},o.apiTermsEndpoint=function(){return this.apiEndpoint()+"/terms"},e}(u.a),f=o(12);e.a=function(){app.store.models["flamarkt-taxonomies"]=h,app.store.models["flamarkt-taxonomy-terms"]=f.a,i.a.prototype.taxonomies=u.a.hasMany("taxonomies"),a.a.prototype.taxonomyTerms=u.a.hasMany("taxonomyTerms"),l.a.prototype.taxonomyTerms=u.a.hasMany("taxonomyTerms"),p.a.prototype.taxonomyTerms=u.a.hasMany("taxonomyTerms")}},,function(t,e){t.exports=flarum.extensions["flamarkt-core"].common["components/Sortable"]},function(t,e){t.exports=flarum.core.compat["common/utils/string"]},,function(t,e){t.exports=flarum.core.compat["common/components/Select"]},,function(t,e){t.exports=flarum.extensions["flamarkt-core"].backoffice["components/BackofficeNav"]},function(t,e){t.exports=flarum.extensions["flamarkt-core"].backoffice["pages/ProductShowPage"]},function(t,e){t.exports=flarum.core.compat["common/components/Page"]},,,,,,,,,,,,function(t,e,o){"use strict";o.r(e);var n=o(35),a=o.n(n),r=o(36),i=o.n(r),s=o(2),l=o(20),u=o.n(l),c=o(1),p=o(37),d=o.n(p),h=o(3),f=o.n(h),x=o(6),v=o.n(x),y=o(30),b=o.n(y),g=o(4),T=o(21),w=o.n(T),k=o(22),F=o(10),I=o.n(F),P=o(31),V=o(5),C=o.n(V),S=o(15),O=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).dirty=!1,e}Object(c.a)(e,t);var o=e.prototype;return o.className=function(){return"Modal--small TaxonomyEditModal"},o.title=function(){return app.translator.trans(this.translationPrefix()+"title."+(this.isNew()?"new":"edit"))},o.content=function(){return m(".Modal-body",[this.form(),m(".FormGroup",[f.a.component({type:"submit",className:"Button Button--primary",loading:this.loading,disabled:!this.dirty},app.translator.trans(this.translationPrefix()+"submit."+(this.isNew()?"new":"edit")))," ",this.isNew()?null:f.a.component({className:"Button Button--link TaxonomyEditModal-delete",loading:this.loading,onclick:this.ondelete.bind(this)},app.translator.trans(this.translationPrefix()+"delete"))])])},e}(o.n(S).a),L=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name=void 0,e.slug=void 0,e.description=void 0,e.color=void 0,e.icon=void 0,e.attrs=void 0,e}Object(c.a)(e,t);var o=e.prototype;return o.oninit=function(e){t.prototype.oninit.call(this,e);var o=this.attrs.term;this.name=o?o.name():"",this.slug=o?o.slug():"",this.description=o?o.description():"",this.color=o?o.color():"",this.icon=o?o.icon():""},o.translationPrefix=function(){return"flamarkt-taxonomies.admin.edit-term."},o.isNew=function(){return!this.attrs.term},o.form=function(){var t=this;return[m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.name")),m("input.FormControl",{type:"text",value:this.name,oninput:C()("value",(function(e){t.name=e,t.slug=Object(P.slug)(e),t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.slug")),m("input.FormControl",{type:"text",value:this.slug,oninput:C()("value",(function(e){t.slug=e,t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.description")),m("textarea.FormControl",{value:this.description,oninput:C()("value",(function(e){t.description=e,t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.color")),m("input.FormControl",{type:"text",value:this.color,oninput:C()("value",(function(e){t.color=e,t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.icon")),m(".helpText",app.translator.trans(this.translationPrefix()+"field.iconDescription",{a:m("a",{href:"https://fontawesome.com/icons?m=free",tabindex:-1})})),m("input.FormControl",{type:"text",value:this.icon,oninput:C()("value",(function(e){t.icon=e,t.dirty=!0}))})])]},o.ondelete=function(){var t=this;confirm(I()(app.translator.trans(this.translationPrefix()+"deleteConfirmation",{name:this.attrs.term.name()})))&&(this.loading=!0,this.attrs.term.delete({errorHandler:this.onerror.bind(this)}).then((function(){app.modal.close(),t.attrs.ondelete&&t.attrs.ondelete()}),(function(){t.loaded()})))},o.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0;var o=this.attrs.term||app.store.createRecord("flamarkt-taxonomy-terms"),n={errorHandler:this.onerror.bind(this)};this.isNew()&&(n.url=app.forum.attribute("apiUrl")+this.attrs.taxonomy.apiTermsEndpoint()),o.save({name:this.name,slug:this.slug,description:this.description,color:this.color,icon:this.icon},n).then((function(){app.modal.close(),e.attrs.onsave&&e.attrs.onsave(o)}),(function(){e.loaded()}))},e}(O),_=o(7),j=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).terms=null,e}Object(c.a)(e,t);var o=e.prototype;return o.oninit=function(e){var o=this;t.prototype.oninit.call(this,e),app.request({method:"GET",url:app.forum.attribute("apiUrl")+this.attrs.taxonomy.apiTermsEndpoint()}).then((function(t){o.terms=app.store.pushPayload(t),m.redraw()}))},o.view=function(){return m(".TaxonomyTermEdit",[null===this.terms?v.a.component({}):this.viewTerms(this.terms)])},o.viewTerms=function(t){var e=this;return[m(b.a,{containerTag:"ol",className:"TaxonomyTermList",handleClassName:null,onsort:function(o,n){t.splice.apply(t,[n,0].concat(t.splice(o,1))),app.request({method:"POST",url:app.forum.attribute("apiUrl")+e.attrs.taxonomy.apiOrderEndpoint(),body:{order:t.map((function(t){return t.id()}))}}).then((function(t){app.store.pushPayload(t)})).catch((function(t){throw m.redraw(),t}))}},t.map((function(e,o){return m("li.TaxonomyTermListItem",{draggable:!0,key:e.id(),style:{color:e.color()}},[Object(_.a)(e),m("span.TaxonomyTermListItem-name",e.name()),f.a.component({className:"Button Button--link",icon:"fas fa-pencil-alt",onclick:function(){app.modal.show(L,{term:e,ondelete:function(){t.splice(o,1)}})}})])}))),f.a.component({className:"Button",onclick:function(){app.modal.show(L,{taxonomy:e.attrs.taxonomy,onsave:function(o){e.terms=Object(k.a)([].concat(t,[o]))}})}},app.translator.trans("flamarkt-taxonomies.admin.page.create.term"))," ",f.a.component({className:"Button",onclick:function(){app.request({method:"POST",url:app.forum.attribute("apiUrl")+e.attrs.taxonomy.apiOrderEndpoint(),body:{order:[]}}).then((function(t){e.terms=app.store.pushPayload(t),m.redraw()})).catch((function(t){throw m.redraw(),t}))}},app.translator.trans("flamarkt-taxonomies.admin.page.reset-term-order"))]},e}(w.a),N=o(33),E=o.n(N),A=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).type=void 0,e.name=void 0,e.slug=void 0,e.description=void 0,e.color=void 0,e.icon=void 0,e.showLabel=void 0,e.showFilter=void 0,e.allowCustomValues=void 0,e.customValueValidation=void 0,e.customValueSlugger=void 0,e.minTerms=void 0,e.maxTerms=void 0,e.attrs=void 0,e}Object(c.a)(e,t);var o=e.prototype;return o.oninit=function(e){t.prototype.oninit.call(this,e);var o=this.attrs.taxonomy;this.type=o?o.type():"products",this.name=o?o.name():"",this.slug=o?o.slug():"",this.description=o?o.description():"",this.color=o?o.color():"",this.icon=o?o.icon():"",this.showLabel=!!o&&o.showLabel(),this.showFilter=!!o&&o.showFilter(),this.allowCustomValues=!!o&&o.allowCustomValues(),this.customValueValidation=(o?o.customValueValidation():null)||"",this.customValueSlugger=(o?o.customValueSlugger():null)||"random",this.minTerms=o?o.minTerms():"",this.maxTerms=o?o.maxTerms():""},o.translationPrefix=function(){return"flamarkt-taxonomies.admin.edit-taxonomy."},o.isNew=function(){return!this.attrs.taxonomy},o.form=function(){var t=this;return[m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.type")),m(".helpText",app.translator.trans(this.translationPrefix()+"field.typeDescription")),E.a.component({options:{products:app.translator.trans(this.translationPrefix()+"type-options.products"),discussions:app.translator.trans(this.translationPrefix()+"type-options.discussions"),users:app.translator.trans(this.translationPrefix()+"type-options.users")},value:this.type,onchange:function(e){t.type=e,t.dirty=!0},disabled:!this.isNew()})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.name")),m("input.FormControl",{type:"text",value:this.name,oninput:C()("value",(function(e){t.name=e,t.slug=Object(P.slug)(e),t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.slug")),m("input.FormControl",{type:"text",value:this.slug,oninput:C()("value",(function(e){t.slug=e,t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.description")),m("textarea.FormControl",{value:this.description,oninput:C()("value",(function(e){t.description=e,t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.color")),m("input.FormControl",{type:"text",value:this.color,oninput:C()("value",(function(e){t.color=e,t.dirty=!0}))})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.icon")),m(".helpText",app.translator.trans(this.translationPrefix()+"field.iconDescription",{a:m("a",{href:"https://fontawesome.com/icons?m=free",tabindex:-1})})),m("input.FormControl",{type:"text",value:this.icon,oninput:C()("value",(function(e){t.icon=e,t.dirty=!0}))})]),m(".Form-group",[m("label",[m("input",{type:"checkbox",checked:this.showLabel,onchange:function(){t.showLabel=!t.showLabel,t.dirty=!0}})," ",app.translator.trans(this.translationPrefix()+"field.showLabel")])]),m(".Form-group",[m("label",[m("input",{type:"checkbox",checked:this.showFilter,onchange:function(){t.showFilter=!t.showFilter,t.dirty=!0}})," ",app.translator.trans(this.translationPrefix()+"field.showFilter")])]),m(".Form-group",[m("label",[m("input",{type:"checkbox",checked:this.allowCustomValues,onchange:function(){t.allowCustomValues=!t.allowCustomValues,t.dirty=!0}})," ",app.translator.trans(this.translationPrefix()+"field.allowCustomValues")])]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.customValueValidation")),E.a.component({options:{"":app.translator.trans(this.translationPrefix()+"validation-options.default"),alpha_num:app.translator.trans(this.translationPrefix()+"validation-options.alpha_num"),alpha_dash:app.translator.trans(this.translationPrefix()+"validation-options.alpha_dash"),regex:app.translator.trans(this.translationPrefix()+"validation-options.regex")},value:0===this.customValueValidation.indexOf("/")?"regex":this.customValueValidation,onchange:function(e){t.customValueValidation="regex"===e?"//":e,t.dirty=!0},disabled:!this.allowCustomValues}),0===this.customValueValidation.indexOf("/")?m(".TaxonomyRegexInput",[m("span","/"),m("input.FormControl",{type:"text",value:this.customValueValidation.split("/")[1],oninput:C()("value",(function(e){t.customValueValidation="/"+e+"/"+t.customValueValidation.split("/")[2],t.dirty=!0})),disabled:!this.allowCustomValues}),m("span","/"),m("input.FormControl",{type:"text",value:this.customValueValidation.split("/")[2],oninput:C()("value",(function(e){t.customValueValidation="/"+t.customValueValidation.split("/")[1]+"/"+e,t.dirty=!0})),disabled:!this.allowCustomValues})]):null]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.customValueSlugger")),m(".helpText",app.translator.trans(this.translationPrefix()+"field.customValueSluggerDescription")),E.a.component({options:{random:app.translator.trans(this.translationPrefix()+"slugger-options.random"),alpha_dash:app.translator.trans(this.translationPrefix()+"slugger-options.alpha_dash"),transliterator:app.translator.trans(this.translationPrefix()+"slugger-options.transliterator")},value:this.customValueSlugger,onchange:function(e){t.customValueSlugger=e,t.dirty=!0},disabled:!this.allowCustomValues})]),m(".Form-group",[m("label",app.translator.trans(this.translationPrefix()+"field.countRequired")),m(".helpText",app.translator.trans(this.translationPrefix()+"field.countRequiredDescription")),m(".TaxonomyModal-rangeInput",[m("input.FormControl",{type:"number",min:0,step:1,value:this.minTerms,oninput:C()("value",(function(e){t.minTerms=parseInt(e)||"",t.dirty=!0}))})," ",app.translator.trans(this.translationPrefix()+"field.rangeSeparatorText")," ",m("input.FormControl",{type:"number",min:0,step:1,value:this.maxTerms,oninput:C()("value",(function(e){t.maxTerms=parseInt(e)||"",t.dirty=!0}))})])])]},o.ondelete=function(){var t=this;confirm(I()(app.translator.trans(this.translationPrefix()+"deleteConfirmation",{name:this.attrs.taxonomy.name()})))&&(this.loading=!0,this.attrs.taxonomy.delete({errorHandler:this.onerror.bind(this)}).then((function(){app.modal.close(),t.attrs.ondelete&&t.attrs.ondelete()}),(function(){t.loaded()})))},o.onsubmit=function(t){var e=this;t.preventDefault(),this.loading=!0;var o=this.attrs.taxonomy||app.store.createRecord("flamarkt-taxonomies");o.save({type:this.type,name:this.name,slug:this.slug,description:this.description,color:this.color,icon:this.icon,show_label:this.showLabel,show_filter:this.showFilter,allow_custom_values:this.allowCustomValues,custom_value_validation:this.customValueValidation,custom_value_slugger:this.customValueSlugger,min_terms:this.minTerms,max_terms:this.maxTerms},{errorHandler:this.onerror.bind(this)}).then((function(){app.modal.close(),e.attrs.onsave&&e.attrs.onsave(o)}),(function(){e.loaded()}))},e}(O),D=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).tabIndex=0,e.taxonomies=null,e}Object(c.a)(e,t);var o=e.prototype;return o.oninit=function(e){var o=this;t.prototype.oninit.call(this,e),app.request({method:"GET",url:app.forum.attribute("apiUrl")+"/flamarkt/taxonomies"}).then((function(t){o.taxonomies=app.store.pushPayload(t),m.redraw()}))},o.view=function(){return m(".TaxonomiesPage",m(".container",[null===this.taxonomies?v.a.component({}):this.viewTaxonomies(this.taxonomies)]))},o.viewTaxonomies=function(t){var e=this;return[m("h2",app.translator.trans("flamarkt-taxonomies.admin.page.title")),m(b.a,{className:"TaxonomyTabs",direction:"horizontal",handleClassName:null,onsort:function(o,n){t.splice.apply(t,[n,0].concat(t.splice(o,1))),app.request({method:"POST",url:app.forum.attribute("apiUrl")+"/flamarkt/taxonomies/order",body:{order:t.map((function(t){return t.id()}))}}).then((function(t){e.taxonomies=app.store.pushPayload(t),e.tabIndex=0})).catch((function(t){throw m.redraw(),t}))}},[].concat(t.map((function(o,n){return m(".TaxonomyTab",{draggable:!0,key:o.id(),onclick:function(){e.tabIndex=n},className:e.tabIndex===n?"active":"",style:{color:o.color()}},[Object(_.a)(o)," ",o.name()," ",f.a.component({className:"Button Button--link",icon:"fas fa-pencil-alt",onclick:function(){app.modal.show(A,{taxonomy:o,ondelete:function(){t.splice(n,1),e.tabIndex=0}})}})])})),[f.a.component({key:"new",className:"TaxonomyTab",icon:"fas fa-plus",onclick:function(){app.modal.show(A,{onsave:function(o){e.taxonomies=Object(g.a)([].concat(t,[o])),e.tabIndex=e.taxonomies.findIndex((function(t){return t===o}))}})}},app.translator.trans("flamarkt-taxonomies.admin.page.create.taxonomy"))])),this.tabIndex<t.length?m("div",m("div",{key:t[this.tabIndex].id()},j.component({taxonomy:t[this.tabIndex]}))):null]},e}(d.a),M=o(28),B=o(14),R=o.n(B),q=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).lastSaveState="neutral",e.dropdownIsFocused=!1,e.onmousedown=void 0,e}Object(c.a)(e,t);var o=e.prototype;return o.oninit=function(e){var o=this;t.prototype.oninit.call(this,e),this.navigator.when((function(t){return" "===t.key&&""===o.searchFilter?(t.preventDefault(),o.select(t),!1):"Tab"!==t.key}))},o.oncreate=function(t){var e=this;this.element=t.dom,this.onmousedown=function(o){var n=t.dom.querySelector(".Dropdown-menu");n&&n.contains(o.target)?e.dropdownIsFocused||(e.dropdownIsFocused=!0,m.redraw()):e.dropdownIsFocused&&(e.dropdownIsFocused=!1,m.redraw())},document.addEventListener("mousedown",this.onmousedown)},o.onbeforeremove=function(){},o.onremove=function(e){t.prototype.onremove.call(this,e),document.removeEventListener("mousedown",this.onmousedown)},o.view=function(){var t=this.attrs.taxonomy.description();return m(".ChooseTaxonomyTermsDropdown",m("form",{onsubmit:function(t){t.preventDefault()}},[m(".ChooseTaxonomyTermsInput",[m(".ChooseTaxonomyTermsModal-form",this.formItems().toArray()),this.listAvailableTerms(this.filteredAvailableTerms())]),t?m("p",t):null]))},o.formItems=function(){var e=t.prototype.formItems.call(this);e.remove("submit");var o=null;return this.saving?o=v.a.component():"success"===this.lastSaveState?o=R()("fas fa-check"):"error"===this.lastSaveState&&(o=R()("fas fa-times")),e.add("status",m(".ChooseTaxonomyTermsStatus",o)),e},o.listAvailableTerms=function(t){return!this.inputIsFocused&&!this.dropdownIsFocused||0===t.length?null:(e=null===this.availableTerms?v.a.component():t.map(this.listAvailableTerm.bind(this)),m("ul.Dropdown-menu.ChooseTaxonomyTermsModal-list",e));var e},o.listAvailableTerm=function(e,o){return m("li",t.prototype.listAvailableTerm.call(this,e,o))},o.toggleTerm=function(e){t.prototype.toggleTerm.call(this,e),this.lastSaveState="neutral",this.saveResource()},o.select=function(t){var e=this.getDomElement(this.activeListIndex);e.length?e[0].dispatchEvent(new Event("click")):this.searchFilter=""},o.onsaved=function(){this.lastSaveState="success",t.prototype.onsaved.call(this)},o.onerror=function(){this.lastSaveState="error",t.prototype.onerror.call(this)},e}(o(9).a);app.initializers.add("flamarkt-taxonomies",(function(){Object(M.a)(),app.routes.taxonomies={path:"/taxonomies",component:D},Object(s.extend)(a.a.prototype,"items",(function(t){t.add("taxonomies",u.a.component({href:app.route("taxonomies"),icon:"fas fa-tags"},app.translator.trans("flamarkt-taxonomies.admin.menu.title")))})),Object(s.extend)(i.a.prototype,"fields",(function(t){var e=this;this.product.exists&&this.product.attribute("canEditTaxonomies")&&Object(g.a)(app.forum.taxonomies()).forEach((function(o){"products"===o.type()&&t.add("taxonomy-"+o.slug(),m(".Form-group",[m("label",o.name()),m(q,{resource:e.product,taxonomy:o})]),-100)}))}))}))}]);
//# sourceMappingURL=backoffice.js.map