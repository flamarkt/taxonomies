module.exports=function(t){var o={};function e(n){if(o[n])return o[n].exports;var a=o[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var a in t)e.d(n,a,function(o){return t[o]}.bind(null,a));return n},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=59)}([function(t,o){t.exports=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{}).app},function(t,o){t.exports=flarum.core.compat["common/Model"]},function(t,o){t.exports=flarum.core.compat["common/app"]},,function(t,o,e){"use strict";function n(t,o){return(n=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t})(t,o)}function a(t,o){t.prototype=Object.create(o.prototype),t.prototype.constructor=t,n(t,o)}e.d(o,"a",(function(){return a}))},function(t,o,e){"use strict";o.a=function(t){return!1===t&&(t=[]),t.slice(0).sort((function(t,o){var e=t.order()-o.order();return 0!==e?e:t.name()>o.name()?1:t.name()<o.name()?-1:0}))}},function(t,o){t.exports=flarum.core.compat["common/extend"]},function(t,o){t.exports=flarum.core.compat["common/components/Button"]},function(t,o,e){"use strict";e.d(o,"a",(function(){return r}));var n=e(22),a=e.n(n);function r(t,o,e){void 0===o&&(o={}),void 0===e&&(e={});var n=t&&t.icon(),r=e.useColor,i=void 0===r||r;return o.className=a()([o.className,"icon",n?t.icon():"TaxonomyIcon"]),t?(o.style=o.style||{},n?o.style.color=i?t.color():"":o.style.backgroundColor=t.color()):o.className+=" untagged",n?m("i",o):m("span",o)}},function(t,o){t.exports=flarum.core.compat["common/components/LoadingIndicator"]},function(t,o,e){"use strict";e.d(o,"a",(function(){return u}));var n=e(2),a=e.n(n),r=e(13),i=e.n(r),s=e(15),l=e(8);function u(t,o){void 0===t&&(t=null),void 0===o&&(o={}),o.style=o.style||{},o.className="TaxonomyLabel "+(o.className||"");var e=i()(o,"discussionLink"),n=i()(o,"userLink"),r=t?t.name():a.a.translator.trans("flarum-tags.lib.deleted_tag_text"),u="span";if(t){var c=t.color();if(c&&(o.style.backgroundColor=o.style.color=c,o.className+=" colored"),t instanceof s.a&&t.taxonomy()&&t.taxonomy().showFilter()){var d;if(e)o.title=t.description()||"",o.href=a.a.route("index",((d={})[t.taxonomy().slug()]=t.slug(),d)),o.config=m.route,u="a";n&&a.a.routes.fof_user_directory&&(o.title=t.description()||"",o.href=a.a.route("fof_user_directory",{q:"taxonomy:"+t.taxonomy().slug()+":"+t.slug()}),o.config=m.route,u="a")}}else o.className+=" untagged";return m(u,o,m("span.TaxonomyLabel-text",[t&&t.icon()&&Object(l.a)(t,{},{useColor:!1})," "+r]))}},function(t,o,e){"use strict";e.d(o,"a",(function(){return C}));var n=e(4),a=e(2),r=e.n(a),i=e(27),s=e.n(i),l=e(28),u=e.n(l),c=e(7),d=e.n(c),f=e(9),h=e.n(f),p=e(32),x=e.n(p),y=e(22),v=e.n(y),b=e(21),g=e.n(b),T=e(23),w=e.n(T),k=e(33),F=e.n(k),I=e(10),P=e(8),V=e(17);var C=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).availableTerms=null,o.selectedTerms=[],o.searchFilter="",o.activeListIndex=0,o.inputIsFocused=!1,o.saving=!1,o.navigator=void 0,o}Object(n.a)(o,t);var e=o.prototype;return e.oninit=function(o){var e=this;t.prototype.oninit.call(this,o),this.attrs.selectedTerms?this.attrs.selectedTerms.forEach(this.addTerm.bind(this)):this.attrs.resource&&this.attrs.resource.taxonomyTerms().forEach((function(t){t.taxonomy().id()===e.attrs.taxonomy.id()&&e.addTerm(t)})),r.a.request({method:"GET",url:r.a.forum.attribute("apiUrl")+this.attrs.taxonomy.apiEndpoint()+"/terms"}).then((function(t){e.availableTerms=r.a.store.pushPayload(t),m.redraw()})),this.navigator=new F.a,this.navigator.onUp((function(){return e.setIndex(e.activeListIndex-1,!0)})).onDown((function(){return e.setIndex(e.activeListIndex+1,!0)})).onSelect(this.select.bind(this)).onRemove((function(){e.selectedTerms.length&&e.toggleTerm(e.selectedTerms[e.selectedTerms.length-1])})).when((function(t){return" "!==t.key||""!==e.searchFilter||(t.preventDefault(),e.select(t),!1)}))},e.indexInSelectedTerms=function(t){return this.selectedTerms.findIndex((function(o){return n=t,(e=o).data.type===n.data.type&&(e.id()&&n.id()?e.id()===n.id():!e.id()==!n.id()&&e.name()===n.name());var e,n}))},e.addTerm=function(t){this.selectedTerms.push(t)},e.removeTerm=function(t){var o=this.indexInSelectedTerms(t);-1!==o&&this.selectedTerms.splice(o,1)},e.className=function(){return"ChooseTaxonomyTermsModal"},e.title=function(){return this.attrs.resource?r.a.translator.trans("flamarkt-taxonomies.lib.modal.title.edit",{taxonomy:this.attrs.taxonomy.name(),title:m("em",this.attrs.resource.title?this.attrs.resource.title():this.attrs.resource.displayName())}):r.a.translator.trans("flamarkt-taxonomies.lib.modal.title.new",{taxonomy:this.attrs.taxonomy.name()})},e.getInstruction=function(){var t=this.selectedTerms.length;if(this.attrs.taxonomy.minTerms()&&t<this.attrs.taxonomy.minTerms()){var o=this.attrs.taxonomy.minTerms()-t;return r.a.translator.trans("flamarkt-taxonomies.lib.modal.placeholder",{count:o})}return 0===t?r.a.translator.trans("flamarkt-taxonomies.lib.modal.placeholderOptional"):""},e.filteredAvailableTerms=function(){var t=null===this.availableTerms?[]:this.availableTerms,o=this.searchFilter.toLowerCase();if(o&&(t=t.filter((function(t){return t.name().substr(0,o.length).toLowerCase()===o})),this.attrs.taxonomy.allowCustomValues()&&!t.some((function(t){return t.name().toLowerCase()===o})))){var e=this.attrs.taxonomy.customValueValidation(),n=null;if("alpha_num"===e)n=/^[a-z0-9]$/i;else if("alpha_dash"===e)n=/^[a-z0-9_-]$/i;else if(0===e.indexOf("/")){var a=e.split("/");3===a.length&&(n=new RegExp(a[1],a[2]))}n&&!n.test(this.searchFilter)||t.push(r.a.store.createRecord("flamarkt-taxonomy-terms",{attributes:{name:this.searchFilter}}))}return this.attrs.taxonomy.maxTerms()&&this.selectedTerms.length>=this.attrs.taxonomy.maxTerms()&&(t=[]),t},e.content=function(){return[this.viewForm(),this.listAvailableTerms(this.filteredAvailableTerms())]},e.viewForm=function(){var t=this.attrs.taxonomy.description();return m(".Modal-body",[t?m("p",t):null,m(".ChooseTaxonomyTermsModal-form",this.formItems().toArray())])},e.formItems=function(){var t=new g.a;return t.add("input",m(".ChooseTaxonomyTermsModal-form-input",m(".TermsInput.FormControl",{className:this.inputIsFocused?"focus":""},this.inputItems().toArray())),20),t.add("submit",m(".ChooseTaxonomyTermsModal-form-submit.App-primaryControl",d.a.component({type:"submit",className:"Button Button--primary",disabled:this.attrs.taxonomy.minTerms()&&this.selectedTerms.length<this.attrs.taxonomy.minTerms(),icon:"fas fa-check",loading:this.saving},r.a.translator.trans("flamarkt-taxonomies.lib.modal.submit"))),10),t},e.inputItems=function(){var t=this,o=new g.a;return o.add("selected",this.selectedTerms.map((function(o){return m("span.TermsInput-term",{onclick:function(){t.toggleTerm(o),t.onready()}},Object(I.a)(o))})),20),o.add("control",m("input.FormControl",{placeholder:w()(this.getInstruction()),value:this.searchFilter,oninput:function(o){t.searchFilter=o.target.value,t.activeListIndex=0},onkeydown:this.navigator.navigate.bind(this.navigator),onfocus:this.oninputfocus.bind(this),onblur:this.oninputblur.bind(this)}),10),o},e.oninputfocus=function(){this.inputIsFocused=!0},e.oninputblur=function(){this.inputIsFocused=!1},e.listAvailableTerms=function(t){return m(".Modal-footer",null===this.availableTerms?h.a.component():m("ul.ChooseTaxonomyTermsModal-list.SelectTermList",{className:t.some((function(t){return t.description()}))?"SelectTermList--with-descriptions":""},t.map(this.listAvailableTerm.bind(this))))},e.listAvailableTerm=function(t,o){var e=this;return m("li.SelectTermListItem",{"data-index":o,className:v()({colored:!!t.color(),selected:-1!==this.indexInSelectedTerms(t),active:this.activeListIndex===o}),style:{color:t.color()},onmouseover:function(){return e.activeListIndex=o},onclick:this.toggleTerm.bind(this,t)},[Object(P.a)(t),m("span.SelectTermListItem-name",t.exists?x()(t.name(),this.searchFilter):r.a.translator.trans("flamarkt-taxonomies.lib.modal.custom",{value:m("em",t.name())})),t.description()?m("span.SelectTermListItem-description",t.description()):""])},e.toggleTerm=function(t){var o=this;-1!==this.indexInSelectedTerms(t)?this.removeTerm(t):this.addTerm(t),this.searchFilter&&(this.searchFilter="",this.activeListIndex=0),setTimeout((function(){o.onready()}))},e.select=function(t){var o=this.getDomElement(this.activeListIndex);o.length?t.metaKey||t.ctrlKey||o.is(".selected")?this.selectedTerms.length&&this.onsubmit():o[0].dispatchEvent(new Event("click")):this.searchFilter=""},e.getDomElement=function(t){return this.$('.SelectTermListItem[data-index="'+t+'"]')},e.setIndex=function(t,o){var e=this.$(".ChooseTaxonomyTermsModal-list"),n=this.$(".SelectTermListItem").length;t<0?t=n-1:t>=n&&(t=0);var a=this.getDomElement(t);if(this.activeListIndex=t,m.redraw(),o){var r,i,s,l=e.scrollTop()||0,u=(null==(r=e.offset())?void 0:r.top)||0,c=u+(e.outerHeight()||0),d=(null==(i=a.offset())?void 0:i.top)||0,f=d+(a.outerHeight()||0);d<u?s=l-u+d-parseInt(e.css("padding-top"),10):f>c&&(s=l-c+f+parseInt(e.css("padding-bottom"),10)),void 0!==s&&e.stop(!0).animate({scrollTop:s},100)}},e.onsubmit=function(t){t&&t.preventDefault(),this.attrs.resource?this.saveResource():(this.attrs.onsubmit&&this.attrs.onsubmit(this.selectedTerms),r.a.modal.close())},e.saveResource=function(){this.saving=!0,this.attrs.resource.save({relationships:{taxonomies:[{verbatim:!0,type:"flamarkt-taxonomies",id:this.attrs.taxonomy.id(),relationships:{terms:{data:this.selectedTerms.map(V.a)}}}]}}).then(this.onsaved.bind(this),this.onerror.bind(this))},e.onsaved=function(){u.a&&r.a.current.matches(u.a)&&r.a.current.get("stream").update(),this.saving=!1,m.redraw(),r.a.modal.close()},e.onerror=function(){this.saving=!1,m.redraw()},o}(s.a)},function(t,o){t.exports=flarum.core.compat["common/utils/withAttr"]},function(t,o){t.exports=flarum.core.compat["common/utils/extract"]},,function(t,o,e){"use strict";e.d(o,"a",(function(){return i}));var n=e(4),a=e(1),r=e.n(a),i=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).name=r.a.attribute("name"),o.slug=r.a.attribute("slug"),o.description=r.a.attribute("description"),o.color=r.a.attribute("color"),o.icon=r.a.attribute("icon"),o.order=r.a.attribute("order"),o.createdAt=r.a.attribute("createdAt",r.a.transformDate),o.taxonomy=r.a.hasOne("taxonomy"),o}return Object(n.a)(o,t),o.prototype.apiEndpoint=function(){return"/flamarkt/taxonomy-terms"+(this.exists?"/"+this.data.id:"")},o}(r.a)},function(t,o,e){"use strict";e.d(o,"a",(function(){return s}));var n=e(13),a=e.n(n),r=e(10),i=e(19);function s(t,o){void 0===o&&(o={});var e=[],n=a()(o,"discussionLink"),s=a()(o,"userLink");if(o.className="TaxonomiesLabel "+(o.className||""),t){var l=a()(o,"taxonomy");l||(l=t[0].taxonomy()),l&&(o["data-slug"]=l.slug(),l.showLabel()&&e.push(Object(r.a)(l,{className:"TaxonomyParentLabel"}))),Object(i.a)(t).forEach((function(o){(o||1===t.length)&&e.push(Object(r.a)(o,{discussionLink:n,userLink:s}))}))}else e.push(Object(r.a)());return m("span",o,e)}},function(t,o,e){"use strict";var n=e(18),a=e(1),r=e.n(a);o.a=function(t){return t.id()?r.a.getIdentifier(t):Object(n.a)({},r.a.getIdentifier(t),{attributes:{name:t.name()}})}},function(t,o,e){"use strict";function n(){return(n=Object.assign||function(t){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}).apply(this,arguments)}e.d(o,"a",(function(){return n}))},function(t,o,e){"use strict";o.a=function(t){return t.slice(0).sort((function(t,o){var e=t.order()-o.order();return 0!==e?e:t.name()>o.name()?1:t.name()<o.name()?-1:0}))}},function(t,o){t.exports=flarum.core.compat["common/helpers/icon"]},function(t,o){t.exports=flarum.core.compat["common/utils/ItemList"]},function(t,o){t.exports=flarum.core.compat["common/utils/classList"]},function(t,o){t.exports=flarum.core.compat["common/utils/extractText"]},function(t,o,e){"use strict";e.d(o,"a",(function(){return i}));var n=e(4),a=e(1),r=e.n(a),i=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).type=r.a.attribute("type"),o.name=r.a.attribute("name"),o.slug=r.a.attribute("slug"),o.description=r.a.attribute("description"),o.color=r.a.attribute("color"),o.icon=r.a.attribute("icon"),o.order=r.a.attribute("order"),o.showLabel=r.a.attribute("showLabel"),o.showFilter=r.a.attribute("showFilter"),o.allowCustomValues=r.a.attribute("allowCustomValues"),o.customValueValidation=r.a.attribute("customValueValidation"),o.customValueSlugger=r.a.attribute("customValueSlugger"),o.minTerms=r.a.attribute("minTerms"),o.maxTerms=r.a.attribute("maxTerms"),o.createdAt=r.a.attribute("createdAt",r.a.transformDate),o.canSearch=r.a.attribute("canSearch"),o}Object(n.a)(o,t);var e=o.prototype;return e.apiEndpoint=function(){return"/flamarkt/taxonomies"+(this.exists?"/"+this.data.id:"")},e.apiOrderEndpoint=function(){return this.apiEndpoint()+"/terms/order"},e.apiTermsEndpoint=function(){return this.apiEndpoint()+"/terms"},o}(r.a)},function(t,o,e){"use strict";var n=e(18),a=e(5),r=e(16);o.a=function(t,o){void 0===o&&(o={});var e=[];return t.forEach((function(t){var o=t.taxonomy();o&&-1===e.indexOf(o)&&e.push(o)})),Object(a.a)(e).map((function(e){return Object(r.a)(t.filter((function(t){return t.taxonomy()===e})),Object(n.a)({},o))}))}},function(t,o,e){"use strict";e.d(o,"a",(function(){return l}));var n=e(4),a=e(9),r=e.n(a),i=e(20),s=e.n(i),l=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).lastSaveState="neutral",o.dropdownIsFocused=!1,o.onmousedown=void 0,o}Object(n.a)(o,t);var e=o.prototype;return e.oninit=function(o){var e=this;t.prototype.oninit.call(this,o),this.navigator.when((function(t){return" "===t.key&&""===e.searchFilter?(t.preventDefault(),e.select(t),!1):"Tab"!==t.key}))},e.oncreate=function(t){var o=this;this.element=t.dom,this.onmousedown=function(e){var n=t.dom.querySelector(".Dropdown-menu");n&&n.contains(e.target)?o.dropdownIsFocused||(o.dropdownIsFocused=!0,m.redraw()):o.dropdownIsFocused&&(o.dropdownIsFocused=!1,m.redraw())},document.addEventListener("mousedown",this.onmousedown)},e.onbeforeremove=function(){},e.onremove=function(o){t.prototype.onremove.call(this,o),document.removeEventListener("mousedown",this.onmousedown)},e.view=function(){var t=this.attrs.taxonomy.description();return m(".ChooseTaxonomyTermsDropdown",m("form",{onsubmit:function(t){t.preventDefault()}},[m(".ChooseTaxonomyTermsInput",[m(".ChooseTaxonomyTermsModal-form",this.formItems().toArray()),this.listAvailableTerms(this.filteredAvailableTerms())]),t?m("p",t):null]))},e.formItems=function(){var o=t.prototype.formItems.call(this);o.remove("submit");var e=null;return this.saving?e=r.a.component():"success"===this.lastSaveState?e=s()("fas fa-check"):"error"===this.lastSaveState&&(e=s()("fas fa-times")),o.add("status",m(".ChooseTaxonomyTermsStatus",e)),o},e.listAvailableTerms=function(t){return!this.inputIsFocused&&!this.dropdownIsFocused||0===t.length?null:(o=null===this.availableTerms?r.a.component():t.map(this.listAvailableTerm.bind(this)),m("ul.Dropdown-menu.ChooseTaxonomyTermsModal-list",o));var o},e.listAvailableTerm=function(o,e){return m("li",t.prototype.listAvailableTerm.call(this,o,e))},e.toggleTerm=function(o){t.prototype.toggleTerm.call(this,o),this.lastSaveState="neutral",this.saveResource()},e.select=function(t){var o=this.getDomElement(this.activeListIndex);o.length?o[0].dispatchEvent(new Event("click")):this.searchFilter=""},e.onsaved=function(){this.lastSaveState="success",t.prototype.onsaved.call(this)},e.onerror=function(){this.lastSaveState="error",t.prototype.onerror.call(this)},o}(e(11).a)},function(t,o){t.exports=flarum.core.compat["common/components/Modal"]},function(t,o){t.exports=flarum.core.compat["forum/components/DiscussionPage"]},function(t,o){t.exports=((flarum.extensions["flamarkt-core"]||{}).common||{})["models/Product"]},function(t,o){t.exports=flarum.core.compat["common/components/LinkButton"]},function(t,o,e){"use strict";e.d(o,"a",(function(){return h}));var n=e(26),a=e(11),r=e(25),i=e(8),s=e(10),l=e(16),m=e(24),u=e(15),c=e(5),d=e(19),f=e(17),h={"components/ChooseTaxonomyTermsDropdown":n.a,"components/ChooseTaxonomyTermsModal":a.a,"helpers/labelsFromMultipleTaxonomiesList":r.a,"helpers/taxonomyIcon":i.a,"helpers/termLabel":s.a,"helpers/termsLabel":l.a,"models/Taxonomy":m.a,"models/Term":u.a,"utils/sortTaxonomies":c.a,"utils/sortTerms":d.a,"utils/termToIdentifier":f.a}},function(t,o){t.exports=flarum.core.compat["common/helpers/highlight"]},function(t,o){t.exports=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["utils/KeyboardNavigatable"]},function(t,o){t.exports=flarum.core.compat["common/Component"]},function(t,o,e){"use strict";var n=e(2),a=e.n(n),r=e(36),i=e.n(r),s=e(37),l=e.n(s),m=e(38),u=e.n(m),c=e(1),d=e.n(c),f=e(29),h=e.n(f),p=e(24),x=e(15);o.a=function(){a.a.store.models["flamarkt-taxonomies"]=p.a,a.a.store.models["flamarkt-taxonomy-terms"]=x.a,l.a.prototype.taxonomies=d.a.hasMany("taxonomies"),i.a.prototype.taxonomyTerms=d.a.hasMany("taxonomyTerms"),u.a.prototype.taxonomyTerms=d.a.hasMany("taxonomyTerms"),h.a&&(h.a.prototype.taxonomyTerms=d.a.hasMany("taxonomyTerms"))}},function(t,o){t.exports=flarum.core.compat["common/models/Discussion"]},function(t,o){t.exports=flarum.core.compat["common/models/Forum"]},function(t,o){t.exports=flarum.core.compat["common/models/User"]},,function(t,o){t.exports=flarum.core.compat["common/utils/string"]},function(t,o){t.exports=((flarum.extensions["flamarkt-backoffice"]||{}).common||{})["components/Sortable"]},,function(t,o){t.exports=flarum.core.compat["common/components/Select"]},function(t,o){t.exports=((flarum.extensions["flamarkt-core"]||{}).backoffice||{})["pages/ProductShowPage"]},,,,function(t,o){t.exports=flarum.core.compat["common/components/Page"]},function(t,o){t.exports=((flarum.extensions["flamarkt-backoffice"]||{}).backoffice||{})["components/BackofficeNav"]},,,,,,,,,,function(t,o,e){"use strict";e.r(o),e.d(o,"common",(function(){return r.a})),e.d(o,"backoffice",(function(){return M}));var n=e(0),a=e.n(n),r=e(31),i=e(4),s=e(27),l=e.n(s),u=e(7),c=e.n(u),d=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).dirty=!1,o}Object(i.a)(o,t);var e=o.prototype;return e.className=function(){return"Modal--small TaxonomyEditModal"},e.title=function(){return a.a.translator.trans(this.translationPrefix()+"title."+(this.isNew()?"new":"edit"))},e.content=function(){return m(".Modal-body",[this.form(),m(".FormGroup",[c.a.component({type:"submit",className:"Button Button--primary",loading:this.loading,disabled:!this.dirty},a.a.translator.trans(this.translationPrefix()+"submit."+(this.isNew()?"new":"edit")))," ",this.isNew()?null:c.a.component({className:"Button Button--link TaxonomyEditModal-delete",loading:this.loading,onclick:this.ondelete.bind(this)},a.a.translator.trans(this.translationPrefix()+"delete"))])])},o}(l.a),f=e(43),h=e.n(f),p=e(40),x=e(12),y=e.n(x),v=e(23),b=e.n(v),g=e(21),T=e.n(g),w=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).type=void 0,o.name=void 0,o.slug=void 0,o.description=void 0,o.color=void 0,o.icon=void 0,o.showLabel=void 0,o.showFilter=void 0,o.allowCustomValues=void 0,o.customValueValidation=void 0,o.customValueSlugger=void 0,o.minTerms=void 0,o.maxTerms=void 0,o}Object(i.a)(o,t);var e=o.prototype;return e.oninit=function(o){t.prototype.oninit.call(this,o);var e=this.attrs.taxonomy;this.type=e?e.type():"discussions",this.name=e?e.name():"",this.slug=e?e.slug():"",this.description=e?e.description():"",this.color=e?e.color():"",this.icon=e?e.icon():"",this.showLabel=!!e&&e.showLabel(),this.showFilter=!!e&&e.showFilter(),this.allowCustomValues=!!e&&e.allowCustomValues(),this.customValueValidation=(e?e.customValueValidation():null)||"",this.customValueSlugger=(e?e.customValueSlugger():null)||"random",this.minTerms=e?e.minTerms():"",this.maxTerms=e?e.maxTerms():""},e.translationPrefix=function(){return"flamarkt-taxonomies.admin.edit-taxonomy."},e.isNew=function(){return!this.attrs.taxonomy},e.form=function(){return this.formItems().toArray()},e.formItems=function(){var t=this,o=new T.a,e={discussions:a.a.translator.trans(this.translationPrefix()+"type-options.discussions"),users:a.a.translator.trans(this.translationPrefix()+"type-options.users")};return("flamarkt-core"in flarum.extensions||"products"===this.type)&&(e.products=a.a.translator.trans(this.translationPrefix()+"type-options.products")),o.add("type",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.type")),m(".helpText",a.a.translator.trans(this.translationPrefix()+"field.typeDescription")),h.a.component({options:e,value:this.type,onchange:function(o){t.type=o,t.dirty=!0},disabled:!this.isNew()})])),o.add("name",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.name")),m("input.FormControl",{type:"text",value:this.name,oninput:y()("value",(function(o){t.name=o,t.slug=Object(p.slug)(o),t.dirty=!0}))})])),o.add("slug",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.slug")),m("input.FormControl",{type:"text",value:this.slug,oninput:y()("value",(function(o){t.slug=o,t.dirty=!0}))})])),o.add("description",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.description")),m("textarea.FormControl",{value:this.description,oninput:y()("value",(function(o){t.description=o,t.dirty=!0}))})])),o.add("color",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.color")),m("input.FormControl",{type:"text",value:this.color,oninput:y()("value",(function(o){t.color=o,t.dirty=!0}))})])),o.add("icon",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.icon")),m(".helpText",a.a.translator.trans(this.translationPrefix()+"field.iconDescription",{a:m("a",{href:"https://fontawesome.com/icons?m=free",tabindex:-1})})),m("input.FormControl",{type:"text",value:this.icon,oninput:y()("value",(function(o){t.icon=o,t.dirty=!0}))})])),o.add("show-label",m(".Form-group",[m("label",[m("input",{type:"checkbox",checked:this.showLabel,onchange:function(){t.showLabel=!t.showLabel,t.dirty=!0}})," ",a.a.translator.trans(this.translationPrefix()+"field.showLabel")])])),o.add("show-filter",m(".Form-group",[m("label",[m("input",{type:"checkbox",checked:this.showFilter,onchange:function(){t.showFilter=!t.showFilter,t.dirty=!0}})," ",a.a.translator.trans(this.translationPrefix()+"field.showFilter")])])),o.add("allow-custom",m(".Form-group",[m("label",[m("input",{type:"checkbox",checked:this.allowCustomValues,onchange:function(){t.allowCustomValues=!t.allowCustomValues,t.dirty=!0}})," ",a.a.translator.trans(this.translationPrefix()+"field.allowCustomValues")])])),o.add("validation",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.customValueValidation")),h.a.component({options:{"":a.a.translator.trans(this.translationPrefix()+"validation-options.default"),alpha_num:a.a.translator.trans(this.translationPrefix()+"validation-options.alpha_num"),alpha_dash:a.a.translator.trans(this.translationPrefix()+"validation-options.alpha_dash"),regex:a.a.translator.trans(this.translationPrefix()+"validation-options.regex")},value:0===this.customValueValidation.indexOf("/")?"regex":this.customValueValidation,onchange:function(o){t.customValueValidation="regex"===o?"//":o,t.dirty=!0},disabled:!this.allowCustomValues}),0===this.customValueValidation.indexOf("/")?m(".TaxonomyRegexInput",[m("span","/"),m("input.FormControl",{type:"text",value:this.customValueValidation.split("/")[1],oninput:y()("value",(function(o){t.customValueValidation="/"+o+"/"+t.customValueValidation.split("/")[2],t.dirty=!0})),disabled:!this.allowCustomValues}),m("span","/"),m("input.FormControl",{type:"text",value:this.customValueValidation.split("/")[2],oninput:y()("value",(function(o){t.customValueValidation="/"+t.customValueValidation.split("/")[1]+"/"+o,t.dirty=!0})),disabled:!this.allowCustomValues})]):null])),o.add("slugger",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.customValueSlugger")),m(".helpText",a.a.translator.trans(this.translationPrefix()+"field.customValueSluggerDescription")),h.a.component({options:{random:a.a.translator.trans(this.translationPrefix()+"slugger-options.random"),alpha_dash:a.a.translator.trans(this.translationPrefix()+"slugger-options.alpha_dash"),transliterator:a.a.translator.trans(this.translationPrefix()+"slugger-options.transliterator")},value:this.customValueSlugger,onchange:function(o){t.customValueSlugger=o,t.dirty=!0},disabled:!this.allowCustomValues})])),o.add("field-counts",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.countRequired")),m(".helpText",a.a.translator.trans(this.translationPrefix()+"field.countRequiredDescription")),m(".TaxonomyModal-rangeInput",[m("input.FormControl",{type:"number",min:0,step:1,value:this.minTerms,oninput:y()("value",(function(o){t.minTerms=parseInt(o)||"",t.dirty=!0}))})," ",a.a.translator.trans(this.translationPrefix()+"field.rangeSeparatorText")," ",m("input.FormControl",{type:"number",min:0,step:1,value:this.maxTerms,oninput:y()("value",(function(o){t.maxTerms=parseInt(o)||"",t.dirty=!0}))})])])),o},e.ondelete=function(){var t=this;confirm(b()(a.a.translator.trans(this.translationPrefix()+"deleteConfirmation",{name:this.attrs.taxonomy.name()})))&&(this.loading=!0,this.attrs.taxonomy.delete({errorHandler:this.onerror.bind(this)}).then((function(){a.a.modal.close(),t.attrs.ondelete&&t.attrs.ondelete()}),(function(){t.loaded()})))},e.onsubmit=function(t){var o=this;t.preventDefault(),this.loading=!0,(this.attrs.taxonomy||a.a.store.createRecord("flamarkt-taxonomies")).save({type:this.type,name:this.name,slug:this.slug,description:this.description,color:this.color,icon:this.icon,show_label:this.showLabel,show_filter:this.showFilter,allow_custom_values:this.allowCustomValues,custom_value_validation:this.customValueValidation,custom_value_slugger:this.customValueSlugger,min_terms:this.minTerms,max_terms:this.maxTerms},{errorHandler:this.onerror.bind(this)}).then((function(t){a.a.modal.close(),o.attrs.onsave&&o.attrs.onsave(t)}),(function(){o.loaded()}))},o}(d),k=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).name=void 0,o.slug=void 0,o.description=void 0,o.color=void 0,o.icon=void 0,o}Object(i.a)(o,t);var e=o.prototype;return e.oninit=function(o){t.prototype.oninit.call(this,o);var e=this.attrs.term;this.name=e?e.name():"",this.slug=e?e.slug():"",this.description=e?e.description():"",this.color=e?e.color():"",this.icon=e?e.icon():""},e.translationPrefix=function(){return"flamarkt-taxonomies.admin.edit-term."},e.isNew=function(){return!this.attrs.term},e.form=function(){return this.formItems().toArray()},e.formItems=function(){var t=this,o=new T.a;return o.add("name",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.name")),m("input.FormControl",{type:"text",value:this.name,oninput:y()("value",(function(o){t.name=o,t.slug=Object(p.slug)(o),t.dirty=!0}))})])),o.add("slug",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.slug")),m("input.FormControl",{type:"text",value:this.slug,oninput:y()("value",(function(o){t.slug=o,t.dirty=!0}))})])),o.add("description",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.description")),m("textarea.FormControl",{value:this.description,oninput:y()("value",(function(o){t.description=o,t.dirty=!0}))})])),o.add("color",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.color")),m("input.FormControl",{type:"text",value:this.color,oninput:y()("value",(function(o){t.color=o,t.dirty=!0}))})])),o.add("icon",m(".Form-group",[m("label",a.a.translator.trans(this.translationPrefix()+"field.icon")),m(".helpText",a.a.translator.trans(this.translationPrefix()+"field.iconDescription",{a:m("a",{href:"https://fontawesome.com/icons?m=free",tabindex:-1})})),m("input.FormControl",{type:"text",value:this.icon,oninput:y()("value",(function(o){t.icon=o,t.dirty=!0}))})])),o},e.ondelete=function(){var t=this;confirm(b()(a.a.translator.trans(this.translationPrefix()+"deleteConfirmation",{name:this.attrs.term.name()})))&&(this.loading=!0,this.attrs.term.delete({errorHandler:this.onerror.bind(this)}).then((function(){a.a.modal.close(),t.attrs.ondelete&&t.attrs.ondelete()}),(function(){t.loaded()})))},e.onsubmit=function(t){var o=this;t.preventDefault(),this.loading=!0;var e=this.attrs.term||a.a.store.createRecord("flamarkt-taxonomy-terms"),n={errorHandler:this.onerror.bind(this)};this.isNew()&&(n.url=a.a.forum.attribute("apiUrl")+this.attrs.taxonomy.apiTermsEndpoint()),e.save({name:this.name,slug:this.slug,description:this.description,color:this.color,icon:this.icon},n).then((function(t){a.a.modal.close(),o.attrs.onsave&&o.attrs.onsave(t)}),(function(){o.loaded()}))},o}(d),F=e(48),I=e.n(F),P=e(9),V=e.n(P),C=e(41),O=e.n(C),L=e(5),S=e(34),j=e.n(S),N=e(19),E=e(8),_=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).terms=null,o}Object(i.a)(o,t);var e=o.prototype;return e.oninit=function(o){var e=this;t.prototype.oninit.call(this,o),a.a.request({method:"GET",url:a.a.forum.attribute("apiUrl")+this.attrs.taxonomy.apiTermsEndpoint()}).then((function(t){e.terms=a.a.store.pushPayload(t),m.redraw()}))},e.view=function(){return m(".TaxonomyTermEdit",[null===this.terms?V.a.component({}):this.viewTerms(this.terms)])},e.viewTerms=function(t){var o=this;return[m(O.a,{containerTag:"ol",className:"TaxonomyTermList",handleClassName:null,onsort:function(e,n){t.splice.apply(t,[n,0].concat(t.splice(e,1))),a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+o.attrs.taxonomy.apiOrderEndpoint(),body:{order:t.map((function(t){return t.id()}))}}).then((function(t){a.a.store.pushPayload(t)})).catch((function(t){throw m.redraw(),t}))}},t.map((function(o,e){return m("li.TaxonomyTermListItem",{draggable:!0,key:o.id(),style:{color:o.color()}},[Object(E.a)(o),m("span.TaxonomyTermListItem-name",o.name()),c.a.component({className:"Button Button--link",icon:"fas fa-pencil-alt",onclick:function(){a.a.modal.show(k,{term:o,ondelete:function(){t.splice(e,1)}})}})])}))),c.a.component({className:"Button",onclick:function(){a.a.modal.show(k,{taxonomy:o.attrs.taxonomy,onsave:function(e){o.terms=Object(N.a)([].concat(t,[e]))}})}},a.a.translator.trans("flamarkt-taxonomies.admin.page.create.term"))," ",c.a.component({className:"Button",onclick:function(){a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+o.attrs.taxonomy.apiOrderEndpoint(),body:{order:[]}}).then((function(t){o.terms=a.a.store.pushPayload(t),m.redraw()})).catch((function(t){throw m.redraw(),t}))}},a.a.translator.trans("flamarkt-taxonomies.admin.page.reset-term-order"))]},o}(j.a),A=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(o=t.call.apply(t,[this].concat(n))||this).tabIndex=0,o.taxonomies=null,o}Object(i.a)(o,t);var e=o.prototype;return e.oninit=function(o){var e=this;t.prototype.oninit.call(this,o),a.a.request({method:"GET",url:a.a.forum.attribute("apiUrl")+"/flamarkt/taxonomies"}).then((function(t){e.taxonomies=a.a.store.pushPayload(t),m.redraw()}))},e.view=function(){return m(".TaxonomiesPage",m(".container",[null===this.taxonomies?V.a.component({}):this.viewTaxonomies(this.taxonomies)]))},e.viewTaxonomies=function(t){var o=this;return[m("h2",a.a.translator.trans("flamarkt-taxonomies.admin.page.title")),m(O.a,{className:"TaxonomyTabs",direction:"horizontal",handleClassName:null,onsort:function(e,n){t.splice.apply(t,[n,0].concat(t.splice(e,1))),a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+"/flamarkt/taxonomies/order",body:{order:t.map((function(t){return t.id()}))}}).then((function(t){o.taxonomies=a.a.store.pushPayload(t),o.tabIndex=0})).catch((function(t){throw m.redraw(),t}))}},[].concat(t.map((function(e,n){return m(".TaxonomyTab",{draggable:!0,key:e.id(),onclick:function(){o.tabIndex=n},className:o.tabIndex===n?"active":"",style:{color:e.color()}},[Object(E.a)(e)," ",e.name()," ",c.a.component({className:"Button Button--link",icon:"fas fa-pencil-alt",onclick:function(){a.a.modal.show(w,{taxonomy:e,ondelete:function(){t.splice(n,1),o.tabIndex=0}})}})])})),[c.a.component({key:"new",className:"TaxonomyTab",icon:"fas fa-plus",onclick:function(){a.a.modal.show(w,{onsave:function(e){o.taxonomies=Object(L.a)([].concat(t,[e])),o.tabIndex=o.taxonomies.findIndex((function(t){return t===e}))}})}},a.a.translator.trans("flamarkt-taxonomies.admin.page.create.taxonomy"))])),this.tabIndex<t.length?m("div",m("div",{key:t[this.tabIndex].id()},_.component({taxonomy:t[this.tabIndex]}))):null]},o}(I.a),M={"components/AbstractEditModal":d,"components/EditTaxonomyModal":w,"components/EditTermModal":k,"components/TaxonomiesPage":A,"components/TaxonomyTermsList":_},D=e(49),B=e.n(D),R=e(44),q=e.n(R),U=e(6),H=e(30),$=e.n(H),z=e(35),G=e(26);a.a.initializers.add("flamarkt-taxonomies",(function(){Object(z.a)(),a.a.routes.taxonomies={path:"/taxonomies",component:A},a.a.extensionData.for("flamarkt-taxonomies").registerSetting((function(){return m(".Form-group",$.a.component({className:"Button",href:a.a.route("taxonomies")},a.a.translator.trans("flamarkt-taxonomies.admin.settings.goToPage")))})),Object(U.extend)(B.a.prototype,"items",(function(t){t.add("taxonomies",$.a.component({href:a.a.route("taxonomies"),icon:"fas fa-tags"},a.a.translator.trans("flamarkt-taxonomies.admin.menu.title")))})),q.a&&Object(U.extend)(q.a.prototype,"fields",(function(t){var o=this;this.product.exists&&this.product.attribute("canEditTaxonomies")&&Object(L.a)(a.a.forum.taxonomies()).forEach((function(e){"products"===e.type()&&t.add("taxonomy-"+e.slug(),m(".Form-group",[m("label",e.name()),m(G.a,{resource:o.product,taxonomy:e})]),-100)}))}))}))}]);
//# sourceMappingURL=backoffice.js.map